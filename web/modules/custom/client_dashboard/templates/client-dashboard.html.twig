{#
/**
 * @file
 * Dashboard template for client dashboard.
 *
 * Available variables:
 * - client_name: The name of the client.
 * - modules_view: Rendered view of modules.
 * - total_modules: Total number of modules.
 * - completed_modules: Number of completed modules.
 * - progress_percentage: Completion percentage.
 * - all_modules_completed: Whether all modules are completed.
 * - report_statuses: Array of report statuses.
 */
#}
<div class="webform-client-dashboard">
	<div class="dashboard-header">
		{% if client_name %}
			<p class="dashboard-subtitle">{{ client_name }}</p>
		{% endif %}
	</div>

	{% if all_modules_completed and report_statuses is not empty %}
		<div class="report-section dashboard-section dashboard-results">
			<h2>{{ 'Your Results'|t }}</h2>
			<p class="report-intro">{{ 'Based on your profile and responses, here are your personalized analysis reports.'|t }}</p>

			{% if report_statuses is not empty %}
				<ol class="analysis-reports results-list">
					{% for type, report_info in report_statuses %}
						<li class="results-list__item report-{{ type }} report-status-{{ report_info.status }} {% if report_info.status == 'ready' and not report_info.viewed %}report-unviewed{% endif %}">
							{% if report_info.status == 'pending' %}
								<div class="results-list__content results-list__content--disabled">
									<h3>
										{{ report_info.title }}
									</h3>
									<p>{{ report_info.description }}</p>
									<span class="results-list__status-text">{{ 'Report Generating...'|t }}</span>
								</div>
							{% else %}
								<a href="{{ report_info.url }}" class="results-list__link" aria-label="Read the {{ report_info.title }} report">
									<div class="results-list__content">
										<h3>
											{{ report_info.title }}
											{% if report_info.status == 'ready' and not report_info.viewed %}
												<span class="badge badge-new">{{ 'New'|t }}</span>
											{% endif %}
										</h3>
										<p>{{ report_info.description }}</p>
									</div>
								</a>
							{% endif %}
						</li>
					{% endfor %}
				</ol>
			{% else %}
				<div class="analysis-callout">
					<p>{{ 'Congratulations on completing all the modules! Your personalized analysis reports are being prepared. Please check back shortly.'|t }}</p>
				</div>
			{% endif %}

		</div>
	{% else %}

		<div class="dashboard-section dashboard-learning">

			<h2>{{ 'Complete Your Profile'|t }}</h2>

			<div class="dashboard-progress">
				<div class="progress-info">
					<span class="progress-text">{{ 'Your Progress'|t }}</span>
					<span class="progress-count">{{ completed_modules }}
						/
						{{ total_modules }}
						{{ 'sections completed'|t }}</span>
				</div>
				<div class="progress-bar">
					<div class="progress-bar-fill" style="width: {{ progress_percentage }}%"></div>
				</div>
				<span class="progress-percentage">{{ progress_percentage }}%</span>
			</div>


			<div class="dashboard-modules">
				{{ modules_view }}
			</div>

		</div>
	{% endif %}
</div>
