{#
/**
 * @file
 * Template for AI Role Impact Analysis Report.
 *
 * Available variables:
 * - report: Complete AI-generated analysis report data
 *   - current_state
 *   - displacement_risk
 *   - skill_evolution
 *   - evolution_path
 *   - value_proposition
 *   - action_plan
 *   - learning_path
 *   - ai_insights
 */
#}

<div
	class="role-impact-report ai-generated">

	{# Pending state - shown while report is being generated #}
	{% if report.status == 'pending' %}
		{% include '@ai_report_storage/report-pending.html.twig' with {
			'report': report,
			'report_title': 'Generating Your Role Impact Analysis'|t
		} %}
	{% else %}

		{# Section 1: Current State #}
		<section
			class="report-section industry-context">
			{# Industry Context #}
			{% if report.ai_insights.industry_context %}
				<div class="industry-context">
					<h2>{{ 'How Your Role is Changing'|t }}</h2>
					<p class="report-intro">{{ report.ai_insights.industry_context.role_evolution }}</p>

					<div class="report-columns">
						<div class="report-column">
							<h3>{{ 'Your Competitive Advantage'|t }}</h4>
							<p>{{ report.ai_insights.industry_context.competitive_advantage }}</p>

						{% endif %}
					</div>

					<div class="report-column">
						<h3>{{ 'Trends to Monitor'|t }}</h4>
						<p>{{ report.ai_insights.industry_context.watch_out_for }}</p>
					</div>
				</div>
			</div>
		</section>

		{# Section 2: Displacement Risk #}
		<section class="report-section displacement-risk risk-{{ report.displacement_risk.risk_level }}">
			<h2>{{ 'Your Displacement Risk'|t }}</h2>

			<div class="risk-header">
				<div class="gauge-wrapper">
					<div class="gauge gauge-large gauge-risk-{{ report.displacement_risk.risk_level }}" data-score="{{ report.displacement_risk.risk_score }}" style="--score: {{ report.displacement_risk.risk_score }}">
						<div class="gauge-fill"></div>
						<div class="gauge-inner">
							<span class="gauge-value">{{ report.displacement_risk.risk_score }}</span>
							<span class="gauge-max">/100</span>
						</div>
					</div>
					<div class="gauge-label">{{ 'Risk Score'|t }}</div>
				</div>
				<div class="risk-summary">
					<p>{{ report.displacement_risk.risk_summary }}</p>
				</div>
			</div>

			{# Personalized Narrative #}
			{% if report.ai_insights.personalized_narrative %}
				<div class="report-intro risk-narrative">
					<p>
						{{ report.ai_insights.personalized_narrative|nl2br }}
					</p>
				</div>
			{% endif %}
		</section>

		{# Section 4: Evolution Path #}
		<section class="report-section evolution-path">
			<h2>{{ 'Your Evolution Path'|t }}:<br>
				{{ report.evolution_path.path_name|default(report.evolution_path.path) }}</h2>


			<div
				class="path-header">
				{# <h3 class="path-name">{{ report.evolution_path.path_name|default(report.evolution_path.path) }}</h3> #}
				<p class="report-intro">{{ report.evolution_path.path_description|default(report.evolution_path.description) }}</p>


				<div class="path-transition">
					<div class="from-state">
						<span class="value">{{ report.evolution_path.from_state|default(report.evolution_path.from) }}</span>
					</div>
					<div class="arrow">â†’</div>
					<div class="to-state">
						<span class="value">{{ report.evolution_path.to_state|default(report.evolution_path.to) }}</span>
					</div>
				</div>
			</div>


			<div class="report-lists path-details">
				<div class="report-list positioning">
					<h3>{{ 'Your Value Proposition'|t }}</h3>
					<ul>
						{% for item in report.evolution_path.positioning_points|default(report.evolution_path.positioning) %}
							<li>{{ item.point|default(item) }}</li>
						{% endfor %}
					</ul>
				</div>

				<div class="report-list obstacles">
					<h3>{{ 'Potential Obstacles'|t }}</h3>
					<ul>
						{% for item in report.evolution_path.obstacles %}
							<li>
								{% if item.obstacle is defined %}
									<strong>{{ item.obstacle }}</strong>
									{% if item.mitigation is defined %}
										<br><em>{{ 'Mitigation'|t }}:</em>
										{{ item.mitigation }}
									{% endif %}
								{% else %}
									{{ item }}
								{% endif %}
							</li>
						{% endfor %}
					</ul>
				</div>

			</div>
		</section>

		<section
			class="report-section confidence-boosters">
			{# Confidence Boosters #}
			{% if report.ai_insights.confidence_boosters %}
				<div class="confidence-boosters">
					<h2>{{ 'Reasons to Be Optimistic'|t }}</h2>
					<div class="confidence-cards">
						{% for item in report.ai_insights.confidence_boosters %}
							<div class="confidence-card">
								<h3>{{ item.insight|default(item.booster|default(item.reason)) }}</h3>
								{% if item.evidence %}
									<p>{{ item.evidence }}</p>
								{% endif %}
							</div>
						{% endfor %}
					</div>
				</div>
			{% endif %}

		</section>

	{% endif %}
	<div class="report-footer">
		<div class="report-actions">
			<a href="/dashboard" class="button button--return">{{ 'Home'|t }}</a>
			<a href="/analysis/skills" class="button button--next">{{ 'Improving Your Skills'|t }}</a>
		</div>
	</div>


</div>
